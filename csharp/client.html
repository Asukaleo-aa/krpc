

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>C# Client &mdash; kRPC 0.3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="kRPC 0.3.0 documentation" href="../index.html"/>
        <link rel="up" title="C#" href="../csharp.html"/>
        <link rel="next" title="KRPC API" href="api/krpc.html"/>
        <link rel="prev" title="C#" href="../csharp.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> kRPC
          

          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials and Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../csharp.html">C#</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">C# Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-library">Installing the Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connecting-to-the-server">Connecting to the Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interacting-with-the-server">Interacting with the Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#streaming-data-from-the-server">Streaming Data from the Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#client-api-reference">Client API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/krpc.html">KRPC API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/space-center.html">SpaceCenter API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/infernal-robotics.html">InfernalRobotics API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/kerbal-alarm-clock.html">Kerbal Alarm Clock API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cpp.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lua.html">Lua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../third-party.html">Other Clients, Services and Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiling.html">Compiling kRPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending.html">Extending kRPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../communication-protocol.html">Communication Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals.html">Internals of kRPC</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">kRPC</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../csharp.html">C#</a> &raquo;</li>
      
    <li>C# Client</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/csharp/client.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="c-client">
<h1>C# Client<a class="headerlink" href="#c-client" title="Permalink to this headline">¶</a></h1>
<p>This client provides functionality to interact with a kRPC server from programs
written in C#. The <code class="docutils literal"><span class="pre">KRPC.Client.dll</span></code> assembly can be <a class="reference external" href="https://www.nuget.com/packages/KRPC.Client">installed using NuGet</a> or
<a class="reference external" href="https://github.com/krpc/krpc/releases/download/v0.3.0/krpc-csharp-0.3.0.zip">downloaded from GitHub</a>.</p>
<div class="section" id="installing-the-library">
<h2>Installing the Library<a class="headerlink" href="#installing-the-library" title="Permalink to this headline">¶</a></h2>
<p>Install the client <a class="reference external" href="https://www.nuget.com/packages/KRPC.Client">using NuGet</a>
or download the assembly <a class="reference external" href="https://github.com/krpc/krpc/releases/download/v0.3.0/krpc-csharp-0.3.0.zip">from GitHub</a> and
reference it in your project. You also need to <a class="reference external" href="https://www.nuget.org/packages/Google.Protobuf">install Google.Protobuf using
NuGet</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The copy of <code class="docutils literal"><span class="pre">Google.Protobuf.dll</span></code> in the GameData folder shipped with the
kRPC server plugin should be <em>avoided</em>. It is a modified version to work
within KSP. <a class="reference external" href="https://github.com/djungelorm/protobuf/releases/tag/v3.0.0-beta-2-net35">See here for more
details.</a></p>
</div>
</div>
<div class="section" id="connecting-to-the-server">
<h2>Connecting to the Server<a class="headerlink" href="#connecting-to-the-server" title="Permalink to this headline">¶</a></h2>
<p>To connect to a server, create a <a class="reference internal" href="#class-Connection" title="Connection class"><code class="xref csharp csharp-type docutils literal"><span class="pre">Connection</span></code></a> object. For example to
connect to a server running on the local machine:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">KRPC.Client</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">KRPC.Client.Services.KRPC</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Connection</span> <span class="p">(</span><span class="n">name</span> <span class="p">:</span> <span class="s">&quot;Example&quot;</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">krpc</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">KRPC</span> <span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">krpc</span><span class="p">.</span><span class="n">GetStatus</span> <span class="p">().</span><span class="n">Version</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The class constructor also accepts arguments that specify what address and port
numbers to connect to. For example:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">KRPC.Client</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">KRPC.Client.Services.KRPC</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Connection</span> <span class="p">(</span>
            <span class="n">name</span> <span class="p">:</span> <span class="s">&quot;Example&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="n">IPAddress</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="s">&quot;10.0.2.2&quot;</span><span class="p">),</span> <span class="n">rpcPort</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span> <span class="n">streamPort</span><span class="p">:</span> <span class="m">1001</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">krpc</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">KRPC</span> <span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">krpc</span><span class="p">.</span><span class="n">GetStatus</span> <span class="p">().</span><span class="n">Version</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="interacting-with-the-server">
<h2>Interacting with the Server<a class="headerlink" href="#interacting-with-the-server" title="Permalink to this headline">¶</a></h2>
<p>kRPC groups remote procedures into services. The functionality for the services
are defined in namespace <code class="docutils literal"><span class="pre">KRPC.Client.Services.*</span></code>.</p>
<p>To interact with a service, you must first instantiate it. The following example
connects to the server, instantiates the SpaceCenter service, and outputs the
name of the active vessel:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">KRPC.Client</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">KRPC.Client.Services.SpaceCenter</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Connection</span> <span class="p">(</span><span class="n">name</span> <span class="p">:</span> <span class="s">&quot;Vessel Name&quot;</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">spaceCenter</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">SpaceCenter</span> <span class="p">();</span>
        <span class="kt">var</span> <span class="n">vessel</span> <span class="p">=</span> <span class="n">spaceCenter</span><span class="p">.</span><span class="n">ActiveVessel</span><span class="p">;</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">vessel</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="streaming-data-from-the-server">
<span id="csharp-client-streams"></span><h2>Streaming Data from the Server<a class="headerlink" href="#streaming-data-from-the-server" title="Permalink to this headline">¶</a></h2>
<p>A stream repeatedly executes a function on the server, with a fixed set of
argument values. It provides a more efficient way of repeatedly getting the
result of a function, avoiding the network overhead of having to invoke it
directly.</p>
<p>For example, consider the following loop that continuously prints out the
position of the active vessel. This loop incurs significant communication
overheads, as the <a class="reference internal" href="api/space-center/vessel.html#method-Vessel.Position" title="Vessel.Position method"><code class="xref csharp csharp-meth docutils literal"><span class="pre">Vessel.Position</span></code></a> method is called repeatedly.</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">KRPC.Client</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">KRPC.Client.Services.SpaceCenter</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Connection</span> <span class="p">();</span>
        <span class="kt">var</span> <span class="n">spaceCenter</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">SpaceCenter</span> <span class="p">();</span>
        <span class="kt">var</span> <span class="n">vessel</span> <span class="p">=</span> <span class="n">spaceCenter</span><span class="p">.</span><span class="n">ActiveVessel</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">refframe</span> <span class="p">=</span> <span class="n">vessel</span><span class="p">.</span><span class="n">Orbit</span><span class="p">.</span><span class="n">Body</span><span class="p">.</span><span class="n">ReferenceFrame</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Out</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">vessel</span><span class="p">.</span><span class="n">Position</span><span class="p">(</span><span class="n">refframe</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following code achieves the same thing, but is far more efficient. It calls
<a class="reference internal" href="#method-Connection.AddStream" title="Connection.AddStream method"><code class="xref csharp csharp-meth docutils literal"><span class="pre">Connection.AddStream</span></code></a> once at the start of the program to create a
stream, and then repeatedly gets the position from the stream.</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">KRPC.Client</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">KRPC.Client.Services.SpaceCenter</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Connection</span> <span class="p">();</span>
        <span class="kt">var</span> <span class="n">spaceCenter</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">SpaceCenter</span> <span class="p">();</span>
        <span class="kt">var</span> <span class="n">vessel</span> <span class="p">=</span> <span class="n">spaceCenter</span><span class="p">.</span><span class="n">ActiveVessel</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">refframe</span> <span class="p">=</span> <span class="n">vessel</span><span class="p">.</span><span class="n">Orbit</span><span class="p">.</span><span class="n">Body</span><span class="p">.</span><span class="n">ReferenceFrame</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">position</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">AddStream</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">vessel</span><span class="p">.</span><span class="n">Position</span><span class="p">(</span><span class="n">refframe</span><span class="p">));</span>
        <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Out</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">Get</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Streams are created for any method call by calling <a class="reference internal" href="#method-Connection.AddStream" title="Connection.AddStream method"><code class="xref csharp csharp-meth docutils literal"><span class="pre">Connection.AddStream</span></code></a>
and passing it a lambda expression calling the desired method. This lambda
expression must take zero arguments and be either a method call expression or a
parameter call expression. It returns an instance of the <a class="reference internal" href="#class-Stream" title="Stream class"><code class="xref csharp csharp-type docutils literal"><span class="pre">Stream</span></code></a> class
from which the latest value can be obtained by calling <a class="reference internal" href="#method-Stream.Get" title="Stream.Get method"><code class="xref csharp csharp-meth docutils literal"><span class="pre">Stream.Get</span></code></a>. A
stream can be stopped and removed from the server by calling
<a class="reference internal" href="#method-Stream.Remove" title="Stream.Remove method"><code class="xref csharp csharp-meth docutils literal"><span class="pre">Stream.Remove</span></code></a> on the stream object. All of a clients streams are
automatically stopped when it disconnects.</p>
</div>
<div class="section" id="client-api-reference">
<h2>Client API Reference<a class="headerlink" href="#client-api-reference" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="class-Connection">
<code class="descname">class Connection</code><a class="headerlink" href="#class-Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>A connection to the kRPC server. All interaction with kRPC is performed via
an instance of this class.</p>
<dl class="method">
<dt>
<code class="descname">Connection (string name = &quot;&quot;, IPAddress address = null, int rpcPort = 50000, int streamPort = 50001)</code></dt>
<dd><p>Connect to a kRPC server on the specified IP address and port numbers. If
streamPort is 0, does not connect to the stream server. Passes an optional
name to the server to identify the client (up to 32 bytes of UTF-8 encoded
text).</p>
</dd></dl>

<dl class="method">
<dt id="method-Connection.AddStream">
<a class="reference internal" href="#class-Stream" title="Stream class">Stream</a>&lt;ReturnType&gt; <code class="descname">AddStream</code>&lt;ReturnType&gt; <span class="sig-paren">(</span>LambdaExpression <em>expression</em><span class="sig-paren">)</span><a class="headerlink" href="#method-Connection.AddStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new stream from the given lambda expression. Returns a stream
object that can be used to obtain the latest value of the stream.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="class-Stream">
<code class="descname">class Stream&lt;ReturnType&gt;</code><a class="headerlink" href="#class-Stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Object representing a stream.</p>
<dl class="method">
<dt id="method-Stream.Get">
ReturnType <code class="descname">Get</code> <span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#method-Stream.Get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the most recent value of the stream.</p>
</dd></dl>

<dl class="method">
<dt id="method-Stream.Remove">
void <code class="descname">Remove</code> <span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#method-Stream.Remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the stream from the server.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/krpc.html" class="btn btn-neutral float-right" title="KRPC API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../csharp.html" class="btn btn-neutral" title="C#" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2016, djungelorm.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61341323-1', 'auto');
  ga('send', 'pageview');
</script>


</body>
</html>