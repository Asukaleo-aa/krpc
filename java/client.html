

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Java Client &mdash; kRPC 0.4.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="kRPC 0.4.0 documentation" href="../index.html"/>
        <link rel="up" title="Java" href="../java.html"/>
        <link rel="next" title="KRPC API" href="api/krpc.html"/>
        <link rel="prev" title="Java" href="../java.html"/>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61341323-1', 'auto');
  ga('send', 'pageview');
</script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> kRPC
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csharp.html">C#</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp.html">C++</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../java.html">Java</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Java Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-the-library">Using the Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connecting-to-the-server">Connecting to the Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calling-remote-procedures">Calling Remote Procedures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#streaming-data-from-the-server">Streaming Data from the Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synchronizing-with-stream-updates">Synchronizing with Stream Updates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#condition-variables">Condition Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#callbacks">Callbacks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#custom-events">Custom Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-krpc.client">Client API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/krpc.html">KRPC API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/space-center.html">SpaceCenter API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/drawing.html">Drawing API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/infernal-robotics.html">InfernalRobotics API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/kerbal-alarm-clock.html">Kerbal Alarm Clock API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/remote-tech.html">RemoteTech API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/ui.html">User Interface API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lua.html">Lua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../third-party.html">Other Clients, Services and Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiling.html">Compiling kRPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending.html">Extending kRPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../communication-protocols.html">Communication Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals.html">Internals of kRPC</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">kRPC</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../java.html">Java</a> &raquo;</li>
        
      <li>Java Client</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/java/client.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="java-client">
<h1>Java Client<a class="headerlink" href="#java-client" title="Permalink to this headline">¶</a></h1>
<p>This client provides a Java API for interacting with a kRPC server. A jar containing the
<code class="docutils literal"><span class="pre">krpc.client</span></code> package can be <a class="reference external" href="https://github.com/krpc/krpc/releases/download/v0.4.0/krpc-java-0.4.0.jar">downloaded from GitHub</a>. It
requires Java version 1.8.</p>
<div class="section" id="using-the-library">
<h2>Using the Library<a class="headerlink" href="#using-the-library" title="Permalink to this headline">¶</a></h2>
<p>The kRPC client library depends on the <a class="reference external" href="https://github.com/google/protobuf/tree/master/java">protobuf</a> and <a class="reference external" href="http://www.javatuples.org">javatuples</a> libraries. A prebuilt jar for protobuf is available via <a class="reference external" href="http://search.maven.org/#search|ga|1|g%3A%22com.google.protobuf%22%20a%3A%22protobuf-java%22">Maven</a>. Note
that you need protobuf version 3. Version 2 is not compatible with kRPC.</p>
<p>The following example program connects to the server, queries it for its version and prints it out:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Basic</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">KRPC</span> <span class="n">krpc</span> <span class="o">=</span> <span class="n">KRPC</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Connected to kRPC version &quot;</span> <span class="o">+</span> <span class="n">krpc</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">getVersion</span><span class="o">());</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>To compile this program using javac on the command line, save the source as <code class="docutils literal"><span class="pre">Example.java</span></code> and run
the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>javac -cp krpc-java-0.4.0.jar:protobuf-java-3.4.0.jar:javatuples-1.2.jar Example.java
</pre></div>
</div>
<p>You may need to change the paths to the JAR files.</p>
</div>
<div class="section" id="connecting-to-the-server">
<h2>Connecting to the Server<a class="headerlink" href="#connecting-to-the-server" title="Permalink to this headline">¶</a></h2>
<p>To connect to a server, call <a class="reference internal" href="#krpc.client.Connection.newInstance()" title="krpc.client.Connection.newInstance()"><code class="xref java java-meth docutils literal"><span class="pre">Connection.newInstance()</span></code></a> which returns a connection object. All
interaction with the server is done via this object. When constructed without any arguments, it will
connect to the local machine on the default port numbers. You can specify different connection
settings, and also a descriptive name for the connection, as follows:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Connecting</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="s">&quot;Remote example&quot;</span><span class="o">,</span> <span class="s">&quot;my.domain.name&quot;</span><span class="o">,</span> <span class="mi">1000</span><span class="o">,</span> <span class="mi">1001</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">KRPC</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">).</span><span class="na">getStatus</span><span class="o">().</span><span class="na">getVersion</span><span class="o">());</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="calling-remote-procedures">
<h2>Calling Remote Procedures<a class="headerlink" href="#calling-remote-procedures" title="Permalink to this headline">¶</a></h2>
<p>The kRPC server provides <em>procedures</em> that a client can run. These procedures are arranged in groups
called <em>services</em> to keep things organized. The functionality for the services are defined in the
package <code class="docutils literal"><span class="pre">krpc.client.services</span></code>. For example, all of the functionality provided by the
<code class="docutils literal"><span class="pre">SpaceCenter</span></code> service is contained in the class <code class="docutils literal"><span class="pre">krpc.client.services.SpaceCenter</span></code>.</p>
<p>To interact with a service, you must first instantiate it. You can then call its methods and
properties to invoke remote procedures. The following example demonstrates how to do this. It
instantiates the <code class="docutils literal"><span class="pre">SpaceCenter</span></code> service and calls
<a class="reference internal" href="api/space-center/space-center.html#krpc.client.services.SpaceCenter.SpaceCenter.getActiveVessel()" title="krpc.client.services.SpaceCenter.SpaceCenter.getActiveVessel()"><code class="xref java java-meth docutils literal"><span class="pre">krpc.client.services.SpaceCenter.SpaceCenter.getActiveVessel()</span></code></a> to get an object representing
the active vessel (of type <a class="reference internal" href="api/space-center/vessel.html#krpc.client.services.SpaceCenter.Vessel" title="krpc.client.services.SpaceCenter.Vessel"><code class="xref java java-type docutils literal"><span class="pre">krpc.client.services.SpaceCenter.Vessel</span></code></a>). It sets the name of the
vessel and then prints out its altitude:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.Vessel</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RemoteProcedures</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="s">&quot;Vessel Name&quot;</span><span class="o">);</span>
    <span class="n">SpaceCenter</span> <span class="n">spaceCenter</span> <span class="o">=</span> <span class="n">SpaceCenter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">Vessel</span> <span class="n">vessel</span> <span class="o">=</span> <span class="n">spaceCenter</span><span class="o">.</span><span class="na">getActiveVessel</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">vessel</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="streaming-data-from-the-server">
<span id="java-client-streams"></span><h2>Streaming Data from the Server<a class="headerlink" href="#streaming-data-from-the-server" title="Permalink to this headline">¶</a></h2>
<p>A common use case for kRPC is to continuously extract data from the game. The naive approach to do
this would be to repeatedly call a remote procedure, such as in the following which repeatedly
prints the position of the active vessel:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.ReferenceFrame</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.Vessel</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Streaming1</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">SpaceCenter</span> <span class="n">spaceCenter</span> <span class="o">=</span> <span class="n">SpaceCenter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">Vessel</span> <span class="n">vessel</span> <span class="o">=</span> <span class="n">spaceCenter</span><span class="o">.</span><span class="na">getActiveVessel</span><span class="o">();</span>
    <span class="n">ReferenceFrame</span> <span class="n">refframe</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="na">getOrbit</span><span class="o">().</span><span class="na">getBody</span><span class="o">().</span><span class="na">getReferenceFrame</span><span class="o">();</span>
    <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">vessel</span><span class="o">.</span><span class="na">position</span><span class="o">(</span><span class="n">refframe</span><span class="o">));</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This approach requires significant communication overhead as request/response messages are
repeatedly sent between the client and server. kRPC provides a more efficient mechanism to achieve
this, called <em>streams</em>.</p>
<p>A stream repeatedly executes a procedure on the server (with a fixed set of argument values) and
sends the result to the client. It only requires a single message to be sent to the server to
establish the stream, which will then continuously send data to the client until the stream is
closed.</p>
<p>The following example does the same thing as above using streams:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.Stream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.StreamException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.ReferenceFrame</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.Vessel</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.javatuples.Triplet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Streaming2</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span><span class="o">,</span> <span class="n">StreamException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">SpaceCenter</span> <span class="n">spaceCenter</span> <span class="o">=</span> <span class="n">SpaceCenter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">Vessel</span> <span class="n">vessel</span> <span class="o">=</span> <span class="n">spaceCenter</span><span class="o">.</span><span class="na">getActiveVessel</span><span class="o">();</span>
    <span class="n">ReferenceFrame</span> <span class="n">refframe</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="na">getOrbit</span><span class="o">().</span><span class="na">getBody</span><span class="o">().</span><span class="na">getReferenceFrame</span><span class="o">();</span>
    <span class="n">Stream</span><span class="o">&lt;</span><span class="n">Triplet</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">,</span><span class="n">Double</span><span class="o">,</span><span class="n">Double</span><span class="o">&gt;&gt;</span> <span class="n">vesselStream</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">addStream</span><span class="o">(</span><span class="n">vessel</span><span class="o">,</span> <span class="s">&quot;position&quot;</span><span class="o">,</span> <span class="n">refframe</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">vesselStream</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>It calls <a class="reference internal" href="#krpc.client.Connection.addStream(Class, String, Object)" title="krpc.client.Connection.addStream(Class, String, Object)"><code class="xref java java-meth docutils literal"><span class="pre">Connection.addStream</span></code></a> once at the start of the program to create the stream, and
then repeatedly prints the position returned by the stream. The stream is automatically closed when
the client disconnects.</p>
<p>A stream can be created for any method call by calling <a class="reference internal" href="#krpc.client.Connection.addStream(Class, String, Object)" title="krpc.client.Connection.addStream(Class, String, Object)"><code class="xref java java-meth docutils literal"><span class="pre">Connection.addStream</span></code></a> and passing it
information about which method to stream. The example above passes a remote object, the name of the
method to call, followed by the arguments to pass to the method (if
any). <a class="reference internal" href="#krpc.client.Connection.addStream(Class, String, Object)" title="krpc.client.Connection.addStream(Class, String, Object)"><code class="xref java java-meth docutils literal"><span class="pre">Connection.addStream</span></code></a> returns a stream object of type <a class="reference internal" href="#krpc.client.Stream" title="krpc.client.Stream"><code class="xref java java-type docutils literal"><span class="pre">Stream</span></code></a>. The most recent
value of the stream can be obtained by calling <a class="reference internal" href="#krpc.client.Stream.get()" title="krpc.client.Stream.get()"><code class="xref java java-meth docutils literal"><span class="pre">Stream.get</span></code></a>. A stream can be stopped and
removed from the server by calling <a class="reference internal" href="#krpc.client.Stream.remove()" title="krpc.client.Stream.remove()"><code class="xref java java-meth docutils literal"><span class="pre">Stream.remove</span></code></a> on the stream object. All of a clients
streams are automatically stopped when it disconnects.</p>
</div>
<div class="section" id="synchronizing-with-stream-updates">
<h2>Synchronizing with Stream Updates<a class="headerlink" href="#synchronizing-with-stream-updates" title="Permalink to this headline">¶</a></h2>
<p>A common use case for kRPC is to wait until the value returned by a method or attribute changes, and
then take some action. kRPC provides two mechanisms to do this efficiently: <em>condition variables</em>
and <em>callbacks</em>.</p>
<div class="section" id="condition-variables">
<h3>Condition Variables<a class="headerlink" href="#condition-variables" title="Permalink to this headline">¶</a></h3>
<p>Each stream has a condition variable associated with it, that is notified whenever the value of the
stream changes. These can be used to block the current thread of execution until the value of the
stream changes.</p>
<p>The following example waits until the abort button is pressed in game, by waiting for the value of
<a class="reference internal" href="api/space-center/control.html#krpc.client.services.SpaceCenter.Control.getAbort()" title="krpc.client.services.SpaceCenter.Control.getAbort()"><code class="xref java java-meth docutils literal"><span class="pre">krpc.client.services.SpaceCenter.Control.getAbort()</span></code></a> to change to true:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.Stream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.StreamException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.Control</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConditionVariables</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span><span class="o">,</span> <span class="n">StreamException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">SpaceCenter</span> <span class="n">spaceCenter</span> <span class="o">=</span> <span class="n">SpaceCenter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">Control</span> <span class="n">control</span> <span class="o">=</span> <span class="n">spaceCenter</span><span class="o">.</span><span class="na">getActiveVessel</span><span class="o">().</span><span class="na">getControl</span><span class="o">();</span>
    <span class="n">Stream</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">abort</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">addStream</span><span class="o">(</span><span class="n">control</span><span class="o">,</span> <span class="s">&quot;getAbort&quot;</span><span class="o">);</span>
    <span class="kd">synchronized</span> <span class="o">(</span><span class="n">abort</span><span class="o">.</span><span class="na">getCondition</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">while</span> <span class="o">(!</span><span class="n">abort</span><span class="o">.</span><span class="na">get</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">abort</span><span class="o">.</span><span class="na">waitForUpdate</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This code creates a stream, acquires a lock on the streams condition variable (by using a
<code class="docutils literal"><span class="pre">synchronized</span></code> block) and then repeatedly checks the value of <code class="docutils literal"><span class="pre">getAbort</span></code>. It leaves the loop
when it changes to true.</p>
<p>The body of the loop calls <code class="docutils literal"><span class="pre">waitForUpdate</span></code> on the stream, which causes the program to block until
the value changes. This prevents the loop from ‘spinning’ and so it does not consume processing
resources whilst waiting.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The stream does not start receiving updates until the first call to <code class="docutils literal"><span class="pre">waitForUpdate</span></code>. This means
that the example code will not miss any updates to the streams value, as it will have already
locked the condition variable before the first stream update is received.</p>
</div>
</div>
<div class="section" id="callbacks">
<h3>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h3>
<p>Streams allow you to register callback functions that are called whenever the value of the stream
changes. Callback functions should take a single argument, which is the new value of the stream, and
should return nothing.</p>
<p>For example the following program registers two callbacks that are invoked when the value of
<a class="reference internal" href="api/space-center/control.html#krpc.client.services.SpaceCenter.Control.getAbort()" title="krpc.client.services.SpaceCenter.Control.getAbort()"><code class="xref java java-meth docutils literal"><span class="pre">krpc.client.services.SpaceCenter.Control.getAbort()</span></code></a> changes:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.Stream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.StreamException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.Control</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Callbacks</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span><span class="o">,</span> <span class="n">StreamException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">SpaceCenter</span> <span class="n">spaceCenter</span> <span class="o">=</span> <span class="n">SpaceCenter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">Control</span> <span class="n">control</span> <span class="o">=</span> <span class="n">spaceCenter</span><span class="o">.</span><span class="na">getActiveVessel</span><span class="o">().</span><span class="na">getControl</span><span class="o">();</span>
    <span class="n">Stream</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">abort</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">addStream</span><span class="o">(</span><span class="n">control</span><span class="o">,</span> <span class="s">&quot;getAbort&quot;</span><span class="o">);</span>
    <span class="n">abort</span><span class="o">.</span><span class="na">addCallback</span><span class="o">(</span>
      <span class="o">(</span><span class="n">Boolean</span> <span class="n">x</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Abort 1 called with a value of &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="o">);</span>
      <span class="o">});</span>
    <span class="n">abort</span><span class="o">.</span><span class="na">addCallback</span><span class="o">(</span>
      <span class="o">(</span><span class="n">Boolean</span> <span class="n">x</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Abort 2 called with a value of &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="o">);</span>
      <span class="o">});</span>
    <span class="n">abort</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

    <span class="c1">// Keep the program running...</span>
    <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When a stream is created it does not start receiving updates until <code class="docutils literal"><span class="pre">start</span></code> is called. This is
implicitly called when accessing the value of a stream, but as this example does not do this an
explicit call to <code class="docutils literal"><span class="pre">start</span></code> is required.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The callbacks are registered before the call to <code class="docutils literal"><span class="pre">start</span></code> so that stream updates are not missed.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The callback function may be called from a different thread to that which created the stream. Any
changes to shared state must therefore be protected with appropriate synchronization.</p>
</div>
</div>
</div>
<div class="section" id="custom-events">
<span id="java-client-events"></span><h2>Custom Events<a class="headerlink" href="#custom-events" title="Permalink to this headline">¶</a></h2>
<p>Some procedures return event objects of type <a class="reference internal" href="#krpc.client.Event" title="krpc.client.Event"><code class="xref java java-type docutils literal"><span class="pre">Event</span></code></a>. These allow you to wait
until an event occurs, by calling <a class="reference internal" href="#krpc.client.Event.waitFor()" title="krpc.client.Event.waitFor()"><code class="xref java java-meth docutils literal"><span class="pre">Event.waitFor</span></code></a>. Under the hood, these are
implemented using streams and condition variables.</p>
<p>Custom events can also be created. An expression API allows you to create code that runs on the
server and these can be used to build a custom event. For example, the following creates the
expression <code class="docutils literal"><span class="pre">MeanAltitude</span> <span class="pre">&gt;</span> <span class="pre">1000</span></code> and then creates an event that will be triggered when the
expression returns true:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">krpc.client.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.RPCException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.Event</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.StreamException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.KRPC.Expression</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.client.services.SpaceCenter.Flight</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">krpc.schema.KRPC.ProcedureCall</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomEvent</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">RPCException</span><span class="o">,</span> <span class="n">StreamException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">KRPC</span> <span class="n">krpc</span> <span class="o">=</span> <span class="n">KRPC</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">SpaceCenter</span> <span class="n">spaceCenter</span> <span class="o">=</span> <span class="n">SpaceCenter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">connection</span><span class="o">);</span>
    <span class="n">Flight</span> <span class="n">flight</span> <span class="o">=</span> <span class="n">spaceCenter</span><span class="o">.</span><span class="na">getActiveVessel</span><span class="o">().</span><span class="na">flight</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>

    <span class="c1">// Get the remote procedure call as a message object,</span>
    <span class="c1">// so it can be passed to the server</span>
    <span class="n">ProcedureCall</span> <span class="n">meanAltitude</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getCall</span><span class="o">(</span><span class="n">flight</span><span class="o">,</span> <span class="s">&quot;getMeanAltitude&quot;</span><span class="o">);</span>

    <span class="c1">// Create an expression on the server</span>
    <span class="n">Expression</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="na">greaterThan</span><span class="o">(</span><span class="n">connection</span><span class="o">,</span>
      <span class="n">Expression</span><span class="o">.</span><span class="na">call</span><span class="o">(</span><span class="n">connection</span><span class="o">,</span> <span class="n">meanAltitude</span><span class="o">),</span>
      <span class="n">Expression</span><span class="o">.</span><span class="na">constantDouble</span><span class="o">(</span><span class="n">connection</span><span class="o">,</span> <span class="mi">1000</span><span class="o">));</span>

    <span class="n">Event</span> <span class="n">event</span> <span class="o">=</span> <span class="n">krpc</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="n">expr</span><span class="o">);</span>
    <span class="kd">synchronized</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getCondition</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">event</span><span class="o">.</span><span class="na">waitFor</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Altitude reached 1000m&quot;</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="package-krpc.client">
<span id="client-api-reference"></span><h2>Client API Reference<a class="headerlink" href="#package-krpc.client" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="krpc.client.Connection">
 class <code class="descname">Connection</code><a class="headerlink" href="#krpc.client.Connection" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>A connection to the kRPC server. All interaction with kRPC is performed via an instance of this
class.</p>
<dl class="method">
<dt id="krpc.client.Connection.newInstance()">
static <a class="reference internal" href="#krpc.client.Connection" title="krpc.client.Connection">Connection</a> <code class="descname">newInstance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.newInstance()" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.newInstance(String)">
static <a class="reference internal" href="#krpc.client.Connection" title="krpc.client.Connection">Connection</a> <code class="descname">newInstance</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> name</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.newInstance(String)" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.newInstance(String, String)">
static <a class="reference internal" href="#krpc.client.Connection" title="krpc.client.Connection">Connection</a> <code class="descname">newInstance</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> name</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> address</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.newInstance(String, String)" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.newInstance(String, String, int, int)">
static <a class="reference internal" href="#krpc.client.Connection" title="krpc.client.Connection">Connection</a> <code class="descname">newInstance</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> name</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> address</em>, int<em> rpcPort</em>, int<em> streamPort</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.newInstance(String, String, int, int)" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.newInstance(String, java.net.InetAddress)">
static <a class="reference internal" href="#krpc.client.Connection" title="krpc.client.Connection">Connection</a> <code class="descname">newInstance</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> name</em>, java.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/net/package-summary.html" title="java.net.package-summary">net</a>.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="java.net.InetAddress">InetAddress</a><em> address</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.newInstance(String, java.net.InetAddress)" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.newInstance(String, java.net.InetAddress, int, int)">
static <a class="reference internal" href="#krpc.client.Connection" title="krpc.client.Connection">Connection</a> <code class="descname">newInstance</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> name</em>, java.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/net/package-summary.html" title="java.net.package-summary">net</a>.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="java.net.InetAddress">InetAddress</a><em> address</em>, int<em> rpcPort</em>, int<em> streamPort</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.newInstance(String, java.net.InetAddress, int, int)" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a connection to the server, using the given connection details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String"><em>String</em></a>) – A descriptive name for the connection. This is passed to the server and
appears in the in-game server window.</li>
<li><strong>address</strong> (<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String"><em>String</em></a>) – The address of the server to connect to. Can either be a hostname, an
IP address as a string or a <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="java.net.InetAddress"><code class="xref java java-ref docutils literal"><span class="pre">java.net.InetAddress</span></code></a>
object. Defaults to 127.0.0.1.</li>
<li><strong>rpc_port</strong> (<em>int</em>) – The port number of the RPC Server. Defaults to 50000. This should match
the RPC port number of the server you want to connect to.</li>
<li><strong>stream_port</strong> (<em>int</em>) – The port number of the Stream Server. Defaults to 50001. This should
match the stream port number of the server you want to connect to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div></blockquote>
<dl class="method">
<dt id="krpc.client.Connection.addStream(Class, String, Object)">
 <a class="reference internal" href="#krpc.client.Stream" title="krpc.client.Stream">Stream</a>&lt;T&gt; <code class="descname">addStream</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html" title="java.lang.Class">Class</a>&lt;?&gt;<em> clazz</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> method</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang.Object">Object</a>...<em> args</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.addStream(Class, String, Object)" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a stream for a static method call to the given class.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.addStream(RemoteObject, String, Object)">
 <a class="reference internal" href="#krpc.client.Stream" title="krpc.client.Stream">Stream</a>&lt;T&gt; <code class="descname">addStream</code><span class="sig-paren">(</span><a class="reference internal" href="#krpc.client.RemoteObject" title="krpc.client.RemoteObject">RemoteObject</a><em> instance</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> method</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang.Object">Object</a>...<em> args</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.addStream(RemoteObject, String, Object)" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a stream for a method call to the given remote object.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.getCall(Class, String, Object)">
 krpc.schema.KRPC.ProcedureCall <code class="descname">getCall</code><span class="sig-paren">(</span><a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html" title="java.lang.Class">Class</a>&lt;?&gt;<em> clazz</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> method</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang.Object">Object</a>...<em> args</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.getCall(Class, String, Object)" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a procedure call message for the given static method call. This allows descriptions of
procedure calls to be passed to the server, for example when constructing custom events. See
<a class="reference internal" href="#java-client-events"><span class="std std-ref">Custom Events</span></a>.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.getCall(RemoteObject, String, Object)">
 krpc.schema.KRPC.ProcedureCall <code class="descname">getCall</code><span class="sig-paren">(</span><a class="reference internal" href="#krpc.client.RemoteObject" title="krpc.client.RemoteObject">RemoteObject</a><em> instance</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="java.lang.String">String</a><em> method</em>, <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang.Object">Object</a>...<em> args</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.getCall(RemoteObject, String, Object)" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a procedure call message for the given method call. This allows descriptions of
procedure calls to be passed to the server, for example when constructing custom events. See
<a class="reference internal" href="#java-client-events"><span class="std std-ref">Custom Events</span></a>.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Connection.close()">
 void <code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Connection.close()" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the connection.</p>
</dd></dl>

</dd></dl>

<dl class="type">
<dt id="krpc.client.Stream">
 class <code class="descname">Stream</code>&lt;T&gt;<a class="headerlink" href="#krpc.client.Stream" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a stream. See <a class="reference internal" href="#java-client-streams"><span class="std std-ref">Streaming Data from the Server</span></a>.</p>
<p>Stream objects implement <code class="docutils literal"><span class="pre">hashCode</span></code> and <code class="docutils literal"><span class="pre">equals</span></code> such that two stream objects are equal if
they are bound to the same stream on the server.</p>
<dl class="method">
<dt id="krpc.client.Stream.start()">
 void <code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.start()" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.startAndWait()">
 void <code class="descname">startAndWait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.startAndWait()" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.get()">
 T <code class="descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.get()" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the most recent value for the stream. If executing the remote procedure for the stream
throws an exception, calling this method will rethrow the exception. Raises a
<code class="docutils literal"><span class="pre">StreamException</span></code> if no update has been received from the server.</p>
<p>If the stream has not been started this method calls <code class="docutils literal"><span class="pre">startAndWait()</span></code> to start the stream
and wait until at least one update has been received.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.getCondition()">
 <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang.Object">Object</a> <code class="descname">getCondition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.getCondition()" title="Permalink to this definition">¶</a></dt>
<dd><p>A condition variable that is notified (using <code class="docutils literal"><span class="pre">notifyAll</span></code>) whenever the value of the stream
changes.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.waitForUpdate()">
 void <code class="descname">waitForUpdate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.waitForUpdate()" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.waitForUpdateWithTimeout(double)">
 void <code class="descname">waitForUpdateWithTimeout</code><span class="sig-paren">(</span>double<em> timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.waitForUpdateWithTimeout(double)" title="Permalink to this definition">¶</a></dt>
<dd><p>These methods block until the value of the stream changes or the operation times out.</p>
<p>The streams condition variable must be locked before calling this method.</p>
<p>If <em>timeout</em> is specified it is the timeout in seconds for the operation.</p>
<p>If the stream has not been started this method calls <code class="docutils literal"><span class="pre">start</span></code> to start the stream (without
waiting for at least one update to be received).</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.addCallback(java.util.function.Consumer)">
 void <code class="descname">addCallback</code><span class="sig-paren">(</span>java.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/util/package-summary.html" title="java.util.package-summary">util</a>.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html" title="java.util.function.package-summary">function</a>.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html" title="java.util.function.Consumer">Consumer</a>&lt;T&gt;<em> callback</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.addCallback(java.util.function.Consumer)" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a callback function that is invoked whenever the value of the stream changes. The
callback function should take one argument, which is passed the new value of the stream.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The callback function may be called from a different thread to that which created the
stream. Any changes to shared state must therefore be protected with appropriate
synchronization.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Stream.remove()">
 void <code class="descname">remove</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Stream.remove()" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the stream from the server.</p>
</dd></dl>

</dd></dl>

<dl class="type">
<dt id="krpc.client.Event">
 class <code class="descname">Event</code><a class="headerlink" href="#krpc.client.Event" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an event. See <a class="reference internal" href="#java-client-events"><span class="std std-ref">Custom Events</span></a>. It is wrapper around a
<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Boolean.html" title="java.lang.Boolean"><code class="xref java java-type docutils literal"><span class="pre">Stream</span></code></a> that indicates when the event occurs.</p>
<p>Event objects implement <code class="docutils literal"><span class="pre">hashCode</span></code> and <code class="docutils literal"><span class="pre">equals</span></code> such that two event objects are equal if they
are bound to the same underlying stream on the server.</p>
<dl class="method">
<dt id="krpc.client.Event.start()">
 void <code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.start()" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the event. When an event is created, it will not receive updates from the server until
this method is called.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Event.getCondition()">
 <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang.Object">Object</a> <code class="descname">getCondition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.getCondition()" title="Permalink to this definition">¶</a></dt>
<dd><p>The condition variable that is notified (using <code class="docutils literal"><span class="pre">notifyAll</span></code>) whenever the event occurs.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Event.waitFor()">
 void <code class="descname">waitFor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.waitFor()" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="krpc.client.Event.waitForWithTimeout(double)">
 void <code class="descname">waitForWithTimeout</code><span class="sig-paren">(</span>double<em> timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.waitForWithTimeout(double)" title="Permalink to this definition">¶</a></dt>
<dd><p>These methods block until the event occurs or the operation times out.</p>
<p>The events condition variable must be locked before calling this method.</p>
<p>If <em>timeout</em> is specified it is the timeout in seconds for the operation.</p>
<p>If the event has not been started this method calls <code class="docutils literal"><span class="pre">start()</span></code> to start the underlying
stream.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Event.addCallback(java.lang.Callable)">
 void <code class="descname">addCallback</code><span class="sig-paren">(</span>java.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/package-summary.html" title="java.lang.package-summary">lang</a>.<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Callable.html" title="java.lang.Callable">Callable</a><em> callback</em><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.addCallback(java.lang.Callable)" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a callback function that is invoked whenever the event occurs. The callback function
should be a function that takes zero arguments.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Event.remove()">
 void <code class="descname">remove</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.remove()" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the event from the server.</p>
</dd></dl>

<dl class="method">
<dt id="krpc.client.Event.getStream()">
 <a class="reference internal" href="#krpc.client.Stream" title="krpc.client.Stream">Stream</a>&lt;<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Boolean.html" title="java.lang.Boolean">Boolean</a>&gt; <code class="descname">getStream</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#krpc.client.Event.getStream()" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the underlying stream for the event.</p>
</dd></dl>

</dd></dl>

<dl class="type">
<dt id="krpc.client.RemoteObject">
abstract class <code class="descname">RemoteObject</code><a class="headerlink" href="#krpc.client.RemoteObject" title="Permalink to this definition">¶</a></dt>
<dd><p>The abstract base class for all remote objects.</p>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/krpc.html" class="btn btn-neutral float-right" title="KRPC API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../java.html" class="btn btn-neutral" title="Java" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, djungelorm.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.4.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  // Open external links in a new window
  jQuery(document).ready(function($) {
    $('a').not('[href*="mailto:"]').each(function () {
      var isInternalLink = new RegExp('/' + window.location.host + '/');
      if (!isInternalLink.test(this.href)) {
        $(this).attr('target', '_blank');
      }
    });
  });
</script>


</body>
</html>